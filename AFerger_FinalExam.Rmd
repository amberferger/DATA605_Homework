---
title: "DATA 605 - Final Exam"
author: "Amber Ferger"
date: "5/15/2020"
output: html_document
---

```{r, include=FALSE}

library(tidyverse)
library(reshape)

```

## Problem 1
**Generate a random variable $X$ that has $10,000$ random uniform numbers from $1$ to $N$, where $N$ can be any number of your choosing greater than or equal to $6$.  Then generate a random variable $Y$ that has $10,000$ random normal numbers with a mean of $\mu = \sigma = \frac{N+1}{2}$.**  

```{r}
set.seed(124)
n <- 10000
N <- 10
mu <- (N+1)/2
sd <- (N+1)/2
X <- runif(n, min = 1, max = N)
Y <- rnorm(n, mean= mu, sd = sd)

```


### Probability  

**Calculate as a minimum the below probabilities $a$ through $c$.  Assume the small letter "x" is estimated as the median of the $X$ variable, and the small letter "y" is estimated as the 1st quartile of the $Y$ variable.  Interpret the meaning of all probabilities.**  
  
***(5 points)***  
**a. P(X>x | X>y)**  
$$P(X>x | X>y) = \frac{P(X>x \cap X>y)}{P(X>y)} = \frac{P(X>x) P(X>y)}{P(X>y)}$$
```{r}
x <- median(X)
y <- as.numeric(quantile(Y)[2])


pXx <- 1 - ((x-min(X))*(1/N))
PXy <- 1 - ((y-min(X)) * (1/N))

(pXx*PXy)/PXy

```
**b. P(X>x, Y>y)**	
$$P(X>x, Y>y) = P(X>x \cap X>y) = P(X>x) P(X>y)$$
```{r}
z <- (y - mu) / sd 
PYy <- 1 - pnorm(z)

pXx*PYy

```
**c. P(X<x | X>y)** 
$$P(X<x | X>y) = \frac{P(X<x \cap X>y)}{P(X>y)} = \frac{P(X<x) P(X>y)}{P(X>y)}$$
```{r}

```


***(5 points)* Investigate whether $P(X>x$ $and$ $Y>y) = P(X>x)P(Y>y)$ by building a table and evaluating the marginal and joint probabilities.**  
  
***(5 points)* Check to see if independence holds by using Fisherâ€™s Exact Test and the Chi Square Test.  What is the difference between the two? Which is most appropriate?**  

# Problem 2
**You are to register for Kaggle.com (free) and compete in the House Prices: Advanced Regression Techniques competition.  https://www.kaggle.com/c/house-prices-advanced-regression-techniques **  

```{r}
trainSet <- read.csv('train.csv', sep=',')
testSet <- read.csv('test.csv', sep=',') 

```
  
## Descriptive and Inferential Statistics (5 points)

**Provide univariate descriptive statistics and appropriate plots for the training data set.  Provide a scatterplot matrix for at least two of the independent variables and the dependent variable. Derive a correlation matrix for any three quantitative variables in the dataset.  Test the hypotheses that the correlations between each pairwise set of variables is 0 and provide an 80% confidence interval.  Discuss the meaning of your analysis.  Would you be worried about familywise error? Why or why not?**  
  
### Plot the data
We'll take a look at the sale prices:
```{r}

hist(trainSet$SalePrice,
     main="Distribution of Sale Prices",
     xlab="Sale Price",
     breaks = 20)

```

The majority of homes fall between $\$100,000$ and $\$200,000$.

``` {r}
boxplot(trainSet$SalePrice,
        main="Boxplot of Sale Prices",
        xlab="Sale Price")

```

The boxplot shows us that we have quite a few outliers. 

### Univariate Descriptive Statistics
```{r}

summary(trainSet)

```


### Scatterplot Matrix
* **Dependent Variable**: SalePrice
* **Independent Variables**: OverallQual, OverallCond

```{r}

spMatrix <- trainSet %>%
  select(SalePrice, OverallQual, OverallCond) 

pairs(spMatrix, gap=0.2)

```

**Quality** - We can see from the graph below that as the quality of the home increases, so does the sale price. 
  
**Condition** - There's a lot more variation in the sale price compared to the overall condition of the home (especially around condition = 5), but in general, we can see as the condition improves, the sale price increases. 

### Correlation Matrix
* **Quantitative Variables**: LotArea, TotalBsmtSF, GrLivArea
  
```{r}

matrixVals <- trainSet %>%
  select(LotArea, TotalBsmtSF, GrLivArea) 

cor(matrixVals)

```
None of the variables appear to be that correlated -- the highest correlation is between GrLivArea and TotalBsmtSF.


Test the hypotheses that the correlations between each pairwise set of variables is 0 and provide an 80% confidence interval. Discuss the meaning of your analysis. Would you be worried about familywise error? Why or why not?


***Linear Algebra and Correlation (5 points)*:  Invert your correlation matrix from above. (This is known as the precision matrix and contains variance inflation factors on the diagonal.) Multiply the correlation matrix by the precision matrix, and then multiply the precision matrix by the correlation matrix. Conduct LU decomposition on the matrix. **  
  
***Calculus-Based Probability & Statistics (5 points)*:  Many times, it makes sense to fit a closed form distribution to data.  Select a variable in the Kaggle.com training dataset that is skewed to the right, shift it so that the minimum value is absolutely above zero if necessary.  Then load the MASS package and run fitdistr to fit an exponential probability density function.  (See  https://stat.ethz.ch/R-manual/R-devel/library/MASS/html/fitdistr.html ).  Find the optimal value of $\lambda$ for this distribution, and then take $1,000$ samples from this exponential distribution using this value (e.g., $rexp(1,000, \lambda)$). Plot a histogram and compare it with a histogram of your original variable. Using the exponential pdf, find the $5^{th}$ and $95^{th}$ percentiles using the cumulative distribution function (CDF). Also generate a $95\%$ confidence interval from the empirical data, assuming normality. Finally, provide the empirical $5^{th}$ percentile and $95^{th}$ percentile of the data. Discuss.**  
  
***Modeling (10 points)*:  Build some type of multiple regression  model and submit your model to the competition board. Provide your complete model summary and results with analysis. Report your Kaggle.com user name and score.**

